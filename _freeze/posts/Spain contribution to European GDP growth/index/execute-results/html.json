{
  "hash": "1dfee5b3ed91ea2c96e94d698f74cdd3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spain contribution to European GDP growth\"\ndate: \"2025-03-15\"\ncategories: [GDP, Eurostat,R]\nexecute:\n  warning: false\n  message: false\n---\n\n\nA journalist recently asked us if an statement from a politician was true. The statement was that Spain represented half of the European growth. In this (first) post we would learn how to do it using Eurostat data and a bit of R.\n\n## Annual data\n\nFirst, I will show the more direct way to do it for annual data. If we want to calculate it for 2024 we need to get the data for Spain and the EU (or Euro area) for 2023 in current prices and for 2024 in previous year prices (prices of 2023). By difference we can calculate the volume change in both areas.\n\nFirst we load the libraries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(eurostat)\nlibrary(dplyr)\nlibrary(tidyr)\n```\n:::\n\n\nAnd we prepare a query for the data we need. First, the year 2023 in current prices:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_23 <- get_eurostat(\"nama_10_gdp\", \n                    filters = list(geo = c(\"ES\", \"EA20\", \"EU27_2020\"),\n                                   na_item = \"B1GQ\",\n                                   unit = c(\"CP_MEUR\"),\n                                   time_period = 2023),\n                    time_format = \"num\") |> \n  select(geo, time, values)\n\nknitr::kable(dat_23)\n```\n\n::: {.cell-output-display}\n\n\n|geo       | time|   values|\n|:---------|----:|--------:|\n|EU27_2020 | 2023| 17197822|\n|EA20      | 2023| 14598181|\n|ES        | 2023|  1498324|\n\n\n:::\n:::\n\n\nAnd after the 2024 in previous year prices\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_24 <- get_eurostat(\"nama_10_gdp\", \n                    filters = list(geo = c(\"ES\", \"EA20\", \"EU27_2020\"),\n                                   na_item = \"B1GQ\",\n                                   unit = c(\"PYP_MEUR\"),\n                                   time_period = 2024),\n                    time_format = \"num\") |> \n  select(geo, time, values)\n\nknitr::kable(dat_24)\n```\n\n::: {.cell-output-display}\n\n\n|geo       | time|   values|\n|:---------|----:|--------:|\n|EU27_2020 | 2024| 17372727|\n|EA20      | 2024| 14722950|\n|ES        | 2024|  1546966|\n\n\n:::\n:::\n\n\nWe bind them together and calculate the change between 2024 and 2023:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- bind_rows(dat_23, dat_24) |> \n  pivot_wider(names_from = time,\n              values_from = values) |> \n  mutate(change = `2024` - `2023`,\n         change_p = round(change / `2023` * 100, 2))  \n\nknitr::kable(dat)\n```\n\n::: {.cell-output-display}\n\n\n|geo       |     2023|     2024|   change| change_p|\n|:---------|--------:|--------:|--------:|--------:|\n|EU27_2020 | 17197822| 17372727| 174905.4|     1.02|\n|EA20      | 14598181| 14722950| 124768.8|     0.85|\n|ES        |  1498324|  1546966|  48642.0|     3.25|\n\n\n:::\n:::\n\n\nSpain grew by 3.25 in 2024 and the EU  by 1.02. But as we are looking for the contribution, we need to divide the change in Spain with the change in the EU.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncont_es_24_eu <- round(dat |> filter(geo == \"ES\") |> select(change) |> pull() / \n                       dat |> filter(geo == \"EU27_2020\") |> select(change) |> pull()\n                       * 100, 2)\n\ncont_es_24_ea <- round(dat |> filter(geo == \"ES\") |> select(change) |> pull() / \n                       dat |> filter(geo == \"EA20\") |> select(change) |> pull()\n                       * 100, 2)\n```\n:::\n\n\n\nFor the EU aggregate the contribution by Spain was 27.81 and for the Euro area 38.99.\n\n## Quarterly data\n\nIn the case of quarterly data, for example comparing the fourth quarter of 2024 with the fourth quarter of 2023, we cannot compared current prices in 2023Q4, which are at the prices of 2023Q4, with the previous year prices of 2024. The easiest way is to use the 2023Q4 in current prices as a kind of weights for the start of the period and calculate the change between 2024Q4 and 2023Q4 in chain linked series.\n\nFirst the current prices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_23_q4 <- get_eurostat(\"namq_10_gdp\", \n                    filters = list(geo = c(\"ES\", \"EA20\", \"EU27_2020\"),\n                                   na_item = \"B1GQ\",\n                                   unit = c(\"CP_MEUR\"),\n                                   s_adj = \"SCA\",\n                                   time_period = \"2024-Q4\"),\n                    time_format = \"raw\") |> \n  select(geo, time, values)\n\nknitr::kable(dat_23_q4)\n```\n\n::: {.cell-output-display}\n\n\n|geo       |time    |  values|\n|:---------|:-------|-------:|\n|EU27_2020 |2024-Q4 | 4554634|\n|EA20      |2024-Q4 | 3842814|\n|ES        |2024-Q4 |  407457|\n\n\n:::\n:::\n\n\nAnd then the chain linked data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_24_q4 <- get_eurostat(\"namq_10_gdp\", \n                    filters = list(geo = c(\"ES\", \"EA20\", \"EU27_2020\"),\n                                   na_item = \"B1GQ\",\n                                   unit = c(\"CLV20_MEUR\"),\n                                   s_adj = \"SCA\",\n                                   time_period = c(\"2023-Q4\",\"2024-Q4\")),\n                    time_format = \"raw\") |> \n  select(geo, time, values)\n\nknitr::kable(dat_24_q4)\n```\n\n::: {.cell-output-display}\n\n\n|geo       |time    |  values|\n|:---------|:-------|-------:|\n|EU27_2020 |2023-Q4 | 3758731|\n|EU27_2020 |2024-Q4 | 3810585|\n|EA20      |2023-Q4 | 3213335|\n|EA20      |2024-Q4 | 3250471|\n|ES        |2023-Q4 |  331427|\n|ES        |2024-Q4 |  342982|\n\n\n:::\n:::\n\n\nWe compute the change between 2024Q4 and 2023Q4.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq_change <- dat_24_q4 |>\n  pivot_wider(names_from = time,\n              values_from = values) |> \n  mutate(change_p = round(`2024-Q4` / `2023-Q4` * 100-100, 3))\n\nknitr::kable(dat_24_q4)\n```\n\n::: {.cell-output-display}\n\n\n|geo       |time    |  values|\n|:---------|:-------|-------:|\n|EU27_2020 |2023-Q4 | 3758731|\n|EU27_2020 |2024-Q4 | 3810585|\n|EA20      |2023-Q4 | 3213335|\n|EA20      |2024-Q4 | 3250471|\n|ES        |2023-Q4 |  331427|\n|ES        |2024-Q4 |  342982|\n\n\n:::\n:::\n\n\nSpain grew by 3.486 between 2024Q4 and 2023Q4 and the EU  by 1.38.\n\nWe combine both datasets to calculate the contribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_23_q4$time <- NULL\nq_change <- q_change |> \n  select(geo,change_p) \n  \ncontrib_q <- full_join(dat_23_q4, q_change) |> \n  mutate(contrib = values * change_p)\n\nknitr::kable(contrib_q)\n```\n\n::: {.cell-output-display}\n\n\n|geo       |  values| change_p| contrib|\n|:---------|-------:|--------:|-------:|\n|EU27_2020 | 4554634|    1.380| 6285395|\n|EA20      | 3842814|    1.156| 4442293|\n|ES        |  407457|    3.486| 1420395|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncont_es_24q4_eu <- round(contrib_q |> filter(geo == \"ES\") |> select(contrib) |> pull() / \n                       contrib_q |> filter(geo == \"EU27_2020\") |> select(contrib) |> pull()\n                       * 100, 2)\n\ncont_es_24q4_ea <- round(contrib_q |> filter(geo == \"ES\") |> select(contrib) |> pull() / \n                       contrib_q |> filter(geo == \"EA20\") |> select(contrib) |> pull()\n                       * 100, 2)\n```\n:::\n\n\nFor the EU the contribution was 22.6 and for the Euro area 31.97.\n\nIt seems after all the statement was **not correct**, although my guess is that probably the politician was adding Portugal and referring to the Euro area. I leave it as an exercise to calculate the contribution of Spain and Portugal.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}